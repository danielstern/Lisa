<!doctype HTML>
<!-- Copyright 2013 danielstern.ca - feel free to examine, learn and apply -->

<html ng-app='lisaApp'> 
<head>
  <title>LISA: The Neuro-Computational Matrix</title>
  <meta name="viewport" content="width=device-width; initial-scale=1.0;">

  <script src="lib/jquery/jquery-1.10.1.min.js"></script> 
  <script src="lib/angular/angular.js"></script>
  <script src="lib/less/less-1.3.3.min.js"></script>
  <script src="lib/bootstrap/js/bootstrap.js"></script>
  <script src="lib/underscore/underscore.js"></script>
  <script src="lib/underscore/underscore.string.min.js"></script>
  <script>
     _.mixin(_.str.exports())
  </script>

  <link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap.css">
  <link rel="stylesheet" type="text/css" href="lib/bootstrap/css/bootstrap-responsive.css">

  <script src="js/logic/Logic.js"></script>
  
  <script src="js/expresso/expressions.js"></script>
  <script src="js/expresso/casualExpressions.js"></script>
  <script src="js/expresso/filter.js"></script>
  <script src="js/expresso/Expresso.js"></script>

  <script src="js/personality/patterns.js"></script>
  <script src="js/personality/Personality.js"></script>
  
  <script src="js/logic/ponder.js"></script>
  
  <script src="lang/transliterate.js"></script>
  <script src="lang/lexicon.js"></script>

  <script src="story/stories.js"></script>

  <!-- LISA -->
  <script src="js/brain/Speech.js"></script>
  <script src="js/brain/Brain.js"></script>
  <script src="js/utility/Utility.js"></script>
  <script src="js/psychic/Psychic.js"></script>
  <script src="js/memory/Memory.js"></script>
  <script src="js/Lisa.js"></script>


</head>
<body>
  <div class='container' ng-controller='LisaController'  style='padding:60px;'>
    <div class="row">
      <div class='span5'>
        <h3>Jack</h3>
           <p id='saying' ng-bind-html-unsafe='saying' ></p>
        <form id='conversation-form' ng-submit='sayRandom()'>
          <input  ng-model='sayTo' type='text'>
        </form>
      </div>
       <div class='span3'>
         <table class='table'>
            <tr>
              <th>Thinking About</th>
              <td>{{thought}}</td>
            </tr>
            </thead>
            <tbody>
              <tr>
                <th>
                  Recently
                </th>
                <td>
                  <p ng-repeat="thing in recentThings|limitTo:3">
                    {{thing.word}}
                 </p>
                </td>
              </tr>
               
              <tr>
                <td colspan='2'>
                  <button class='btn' ng-click='scopeUp()'>Scope Up</button>
                  <button class='btn' ng-click='scopeDown()'>Scope Down</button>
                  <button class='btn' ng-click='scopeSideways()'>Scope Sideways</button>
                  <button class='btn' ng-click='sayRandom()'>Keep Talking</button>
                </td>
              </tr>
            </tbody>
         </table>
      </div>
      <div class='span3'>
        <!--<img src='../misc/nick.jpg' width='200px' height='auto'>-->
        <table class='table'>
          <tr>
            <th>
              Random Things
            </th>
            <td>
              <p ng-repeat="thing in randomThings|limitTo:3">
                {{thing.word}}
             </p>
            </td>
          </tr>
        </table>
      </div>
      
    </div>

  </div>
</body>

<script>

  var lisaApp = angular.module('lisaApp',[])
   .controller('LisaController', ['$scope', function($scope) {

      var $Lisa = new Lisa();
      $scope.thought = 'Unknown';

      $scope.saying = '...'
      $scope.randomThings = _.sample(brain.lexicon.things, 3)

      $scope.sayTo = 'mother';
      $scope.recentThings = [];

      $scope.sayRandom = function() {

        var reply = $Lisa.hears($scope.sayTo);
        $scope.saying = reply[0];
        if (!reply[1])    return;
        $scope.thought = reply[1].word;
        $scope.recentThings.push(reply[1] || '?');

        $scope.recentThings = _.last($scope.recentThings, 3);
              $scope.sayTo = '';

      }

      $scope.scopeUp = function(){$scope.lisaDirective('scopeUp')};
      $scope.scopeSideways = function(){$scope.lisaDirective('scopeSideways')};
      $scope.scopeDown = function(){$scope.lisaDirective('scopeDown')};

      $scope.lisaDirective = function(directive) {

        var lisaDo = $Lisa.do(directive);

        $Lisa.brain.seed = lisaDo[1];
        $scope.saying = lisaDo[0];
        $scope.thought = lisaDo[1].word;
        $scope.sayTo = '';
      }
  }])
  

</script>
<style>
 .word_split span:hover {
    font-weight:bold;
}
</style>